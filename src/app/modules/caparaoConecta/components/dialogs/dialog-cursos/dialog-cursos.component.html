@if(this.data.id){
<header class="d-flex justify-content-between align-items-center px-4 pt-3">
  <h3>Adicionar curso realizado</h3>
  <button class="btn" (click)="closeModal()">
    <img src="assets/icons/close.svg" alt="Botão para fechar o dialog" />
  </button>
</header>

<mat-dialog-content>
  <form [formGroup]="form">
    <div class="col flex-grow-1 input-container">
      <mat-label class="cpc-medium-010">Instituição de ensino</mat-label>
      <mat-form-field class="example-full-width w-100">
        <input
          type="text"
          matInput
          formControlName="instituicao"
          placeholder="Preencha sua Instituição"
          [matAutocomplete]="auto"
        />
        <mat-autocomplete
          #auto="matAutocomplete"
          [displayWith]="displayFnInstituicao"
        >
          @for (option of filteredOptions | async; track option) {
          <mat-option [value]="option">{{ option.nome }}</mat-option>
          }
        </mat-autocomplete>
        <mat-error
          class="cpc-regular-010"
          *ngIf="
            form.get('instituicao')?.hasError('required') &&
            form.get('instituicao')?.touched
          "
          >Instituição é obrigatória</mat-error
        >
      </mat-form-field>
    </div>

    <div class="col flex-grow-1 input-container">
      <mat-label class="cpc-medium-010">Curso</mat-label>
      <mat-form-field class="example-full-width w-100">
        <input
          type="text"
          matInput
          formControlName="id_cursos"
          placeholder="Preencha seu curso"
          [matAutocomplete]="autoCurso"
        />
        <mat-autocomplete
          #autoCurso="matAutocomplete"
          [displayWith]="displayFnCurso"
        >
          @for (curso of filteredOptionsCursos | async; track curso) {
          <mat-option [value]="curso">{{ curso.curso }}</mat-option>
          } @if (optionsCursos.length === 0 && form.get('instituicao')?.value) {
          <mat-option disabled
            >Nenhum curso encontrado para esta instituição</mat-option
          >
          } @if (!form.get('instituicao')?.value) {
          <mat-option disabled>Selecione uma instituição primeiro</mat-option>
          }
        </mat-autocomplete>
        <mat-error
          class="cpc-regular-010"
          *ngIf="
            form.get('id_cursos')?.hasError('required') &&
            form.get('id_cursos')?.touched
          "
          >Curso é obrigatório</mat-error
        >
      </mat-form-field>
    </div>

    <div class="d-flex flex-column py-3">
      <mat-label class="cpc-medium-010 pb-2">Possui certificado?</mat-label>
      <mat-radio-group formControlName="certificado_curso">
        <mat-radio-button [value]="true">Sim</mat-radio-button>
        <mat-radio-button [value]="false">Não</mat-radio-button>
      </mat-radio-group>
    </div>

    @if(form.get('certificado_curso')?.value == true) {
    <div class="col flex-grow-1 input-container">
      <mat-label class="cpc-medium-010">Data conclusão</mat-label>
      <mat-form-field class="example-full-width w-100">
        <input
          type="date"
          matInput
          formControlName="data_conclusao"
          placeholder="Mês/Ano"
        />
        <mat-error
          class="cpc-regular-010"
          *ngIf="
            form.get('data_conclusao')?.hasError('required') &&
            form.get('data_conclusao')?.touched
          "
        >
          Data de conclusão é obrigatória
        </mat-error>
        <mat-error
          *ngIf="
            form.get('data_conclusao')?.hasError('matDatepickerParse') &&
            form.get('data_conclusao')?.touched
          "
        >
          Formato de data inválido
        </mat-error>
        <mat-error
          *ngIf="
            form.get('data_conclusao')?.hasError('invalidDate') &&
            form.get('data_conclusao')?.touched
          "
        >
          Data de conclusão inválida
        </mat-error>
      </mat-form-field>
    </div>
    }
    <div class="d-flex justify-content-end">
      <app-button-primary
        fonte="cpc-regular"
        color="btn-secondary"
        text="Salvar"
        (click)="submit()"
        [disabled]="form.invalid"
      />
    </div>
  </form>
</mat-dialog-content>
}@else {
<header class="d-flex justify-content-between align-items-center px-4 pt-3">
  <h3>Adicionar curso realizado</h3>
  <button class="btn" (click)="closeModal()">
    <img src="assets/icons/close.svg" alt="Botão para fechar o dialog" />
  </button>
</header>

<mat-dialog-content>
  <form [formGroup]="form">
    <div class="col flex-grow-1 input-container">
      <mat-label class="cpc-medium-010">Instituição de ensino</mat-label>
      <mat-form-field class="example-full-width w-100">
        <input
          type="text"
          matInput
          formControlName="instituicao"
          placeholder="Preencha sua Instituição"
          [matAutocomplete]="auto"
        />
        <mat-autocomplete
          #auto="matAutocomplete"
          [displayWith]="displayFnInstituicao"
        >
          @for (option of filteredOptions | async; track option) {
          <mat-option [value]="option">{{ option.nome }}</mat-option>
          }
        </mat-autocomplete>
        <mat-error
          class="cpc-regular-010"
          *ngIf="
            form.get('instituicao')?.hasError('required') &&
            form.get('instituicao')?.touched
          "
          >Instituição é obrigatória</mat-error
        >
      </mat-form-field>
    </div>

    <div class="col flex-grow-1 input-container">
      <mat-label class="cpc-medium-010">Curso</mat-label>
      <mat-form-field class="example-full-width w-100">
        <input
          type="text"
          matInput
          formControlName="id_cursos"
          placeholder="Preencha seu curso"
          [matAutocomplete]="autoCurso"
        />
        <mat-autocomplete
          #autoCurso="matAutocomplete"
          [displayWith]="displayFnCurso"
        >
          @for (curso of filteredOptionsCursos | async; track curso) {
          <mat-option [value]="curso">{{ curso.curso }}</mat-option>
          } @if (optionsCursos.length === 0 && form.get('instituicao')?.value) {
          <mat-option disabled
            >Nenhum curso encontrado para esta instituição</mat-option
          >
          } @if (!form.get('instituicao')?.value) {
          <mat-option disabled>Selecione uma instituição primeiro</mat-option>
          }
        </mat-autocomplete>
        <mat-error
          class="cpc-regular-010"
          *ngIf="
            form.get('id_cursos')?.hasError('required') &&
            form.get('id_cursos')?.touched
          "
          >Curso é obrigatório</mat-error
        >
      </mat-form-field>
    </div>

    <div class="d-flex flex-column py-3">
      <mat-label class="cpc-medium-010 pb-2">Possui certificado?</mat-label>
      <mat-radio-group formControlName="certificado_curso">
        <mat-radio-button [value]="true">Sim</mat-radio-button>
        <mat-radio-button [value]="false">Não</mat-radio-button>
      </mat-radio-group>
    </div>

    @if(form.get('certificado_curso')?.value == true) {
    <div class="col flex-grow-1 input-container">
      <mat-label class="cpc-medium-010">Data conclusão</mat-label>
      <mat-form-field class="example-full-width w-100">
        <input
          type="date"
          matInput
          formControlName="data_conclusao"
          placeholder="Mês/Ano"
        />
        <mat-error
          class="cpc-regular-010"
          *ngIf="
            form.get('data_conclusao')?.hasError('required') &&
            form.get('data_conclusao')?.touched
          "
        >
          Data de conclusão é obrigatória
        </mat-error>
        <mat-error
          *ngIf="
            form.get('data_conclusao')?.hasError('matDatepickerParse') &&
            form.get('data_conclusao')?.touched
          "
        >
          Formato de data inválido
        </mat-error>
        <mat-error
          *ngIf="
            form.get('data_conclusao')?.hasError('invalidDate') &&
            form.get('data_conclusao')?.touched
          "
        >
          Data de conclusão inválida
        </mat-error>
      </mat-form-field>
    </div>
    }
    <div class="d-flex justify-content-end">
      <app-button-primary
        fonte="cpc-regular"
        color="btn-secondary"
        text="Salvar"
        (click)="update()"
      />
    </div>
  </form>
</mat-dialog-content>
}
