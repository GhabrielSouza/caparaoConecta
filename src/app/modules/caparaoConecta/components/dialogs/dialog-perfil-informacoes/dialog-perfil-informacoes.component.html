<header class="d-flex justify-content-between align-items-center px-4 pt-3">
  <h3>Editar Perfil</h3>
  <button class="btn" (click)="closeModal()">
    <img src="assets/icons/close.svg" alt="Botão para fechar o dialog" />
  </button>
</header>
<mat-dialog-content>
  <form [formGroup]="cadastrarForm" class="row">
    <app-primary-input
      formControlName="nome"
      type="text"
      placeholder="Digite seu nome"
      label="Nome"
      inputName="nome"
      class="col-12"
    >
      @if (cadastrarForm.get('nome')?.invalid &&
      (cadastrarForm.get('nome')?.touched || cadastrarForm.get('nome')?.dirty ))
      {
      <mat-error>{{ fieldErrors()["nome"] }}</mat-error>
      }
    </app-primary-input>
    @if(data.conteudo.usuario.id_tipo_usuarios == 2) {
    <app-primary-input
      formControlName="sobrenome"
      type="text"
      placeholder="Digite seu nome"
      label="Sobrenome"
      inputName="sobrenome"
      class="col-12"
    >
      @if (cadastrarForm.get('sobrenome')?.invalid &&
      (cadastrarForm.get('sobrenome')?.touched ||
      cadastrarForm.get('sobrenome')?.dirty )) {
      <mat-error>{{ fieldErrors()["sobrenome"] }}</mat-error>
      }
    </app-primary-input>

    <div class="d-flex">
      <app-data-nascimento-input
        formControlName="data_de_nascimento"
        type="text"
        placeholder="dd/mm/yyyy"
        label="Data de nascimento"
        inputName="data_de_nascimento"
        class="col-6"
      >
        @if (cadastrarForm.get('data_de_nascimento')?.invalid &&
        (cadastrarForm.get('data_de_nascimento')?.touched ||
        cadastrarForm.get('data_de_nascimento')?.dirty )) {
        <mat-error>{{ fieldErrors()["data_de_nascimento"] }}</mat-error>
        }
      </app-data-nascimento-input>

      <app-genero-input
        formControlName="genero"
        type="text"
        placeholder="Selecione seu gênero"
        label="Gênero"
        inputName="genero"
        class="col-6 ps-3"
      >
        @if (cadastrarForm.get('genero')?.invalid &&
        (cadastrarForm.get('genero')?.touched ||
        cadastrarForm.get('genero')?.dirty )) {
        <mat-error>{{ fieldErrors()["genero"] }}</mat-error>
        }
      </app-genero-input>
    </div>
    }

    <app-primary-input
      type="text"
      formControlName="instagram"
      inputName="instagram"
      label="Instagram"
      placeholder="Insira seu link"
    >
      @if (cadastrarForm.get('confirmPassword')?.invalid &&
      (cadastrarForm.get('confirmPassword')?.touched ||
      cadastrarForm.get('confirmPassword')?.dirty )){
      <mat-error>{{ fieldErrors()["confirmPassword"] }}</mat-error>
      } @if (cadastrarForm.errors?.['Invalida']) {
      <mat-error> As senhas não coincidem.</mat-error>
      }
    </app-primary-input>
    <app-primary-input
      type="text"
      formControlName="lattes"
      inputName="lattes"
      label="Lattes"
      placeholder="Insira seu link"
    >
      @if (cadastrarForm.get('confirmPassword')?.invalid &&
      (cadastrarForm.get('confirmPassword')?.touched ||
      cadastrarForm.get('confirmPassword')?.dirty )){
      <mat-error>{{ fieldErrors()["confirmPassword"] }}</mat-error>
      } @if (cadastrarForm.errors?.['Invalida']) {
      <mat-error> As senhas não coincidem.</mat-error>
      }
    </app-primary-input>
    <app-primary-input
      type="text"
      formControlName="github"
      inputName="github"
      label="Github"
      placeholder="Insira seu link"
    >
      @if (cadastrarForm.get('confirmPassword')?.invalid &&
      (cadastrarForm.get('confirmPassword')?.touched ||
      cadastrarForm.get('confirmPassword')?.dirty )){
      <mat-error>{{ fieldErrors()["confirmPassword"] }}</mat-error>
      } @if (cadastrarForm.errors?.['Invalida']) {
      <mat-error> As senhas não coincidem.</mat-error>
      }
    </app-primary-input>
    <app-primary-input
      type="text"
      formControlName="linkedin"
      inputName="linkedin"
      label="Linkedin"
      placeholder="Insira seu link"
    >
      @if (cadastrarForm.get('confirmPassword')?.invalid &&
      (cadastrarForm.get('confirmPassword')?.touched ||
      cadastrarForm.get('confirmPassword')?.dirty )){
      <mat-error>{{ fieldErrors()["confirmPassword"] }}</mat-error>
      } @if (cadastrarForm.errors?.['Invalida']) {
      <mat-error> As senhas não coincidem.</mat-error>
      }
    </app-primary-input>

    <app-telefone-input
      formControlName="telefone"
      type="tel"
      placeholder="Digite seu número"
      label="Telefone(DDD)"
      inputName="telefone"
      >@if (cadastrarForm.get('telefone')?.invalid &&
      (cadastrarForm.get('telefone')?.touched ||
      cadastrarForm.get('telefone')?.dirty )) {
      <mat-error>{{ fieldErrors()["telefone"] }}</mat-error>
      }</app-telefone-input
    >
    <div class="d-flex gap-3 align-items-start">
      <div class="flex-grow-1 input-container">
        <mat-label class="d-block">Estado</mat-label>
        <mat-form-field class="w-100">
          <mat-select
            formControlName="estado"
            placeholder="Selecione seu estado"
            (selectionChange)="carregarCidadesPorEstado($event.value.id)"
            [compareWith]="compararEstados"
          >
            @for(estado of estados; track estado.id){
            <mat-option [value]="estado">
              {{ estado.nome }}
            </mat-option>
            }
          </mat-select>
          @if (cadastrarForm.get('estado')?.invalid &&
          (cadastrarForm.get('estado')?.touched ||
          cadastrarForm.get('estado')?.dirty)) {
          <mat-error>{{ fieldErrors()["estado"] }}</mat-error>
          }
        </mat-form-field>
      </div>

      <!-- Campo de Cidade -->
      <div class="flex-grow-1 input-container">
        <mat-label class="d-block">Cidade</mat-label>
        <!-- Label posicionado acima -->
        <mat-form-field class="w-100">
          <mat-select
            formControlName="cidade"
            placeholder="Selecione sua cidade"
          >
            @for(cidade of cidades; track cidade.id){
            <mat-option [value]="cidade.nome">
              {{ cidade.nome }}
            </mat-option>
            }
          </mat-select>
          @if (cadastrarForm.get('cidade')?.invalid &&
          (cadastrarForm.get('cidade')?.touched ||
          cadastrarForm.get('cidade')?.dirty)) {
          <mat-error>{{ fieldErrors()["cidade"] }}</mat-error>
          }
        </mat-form-field>
      </div>
    </div>
    @if(data.conteudo.usuario.id_tipo_usuarios == 2) {
    <div class="flex-grow-1 input-container">
      <mat-label class="d-block">Área de Atuação</mat-label>
      <!-- Label posicionado acima -->
      <mat-form-field class="w-100">
        <mat-select
          formControlName="id_areas_atuacao"
          placeholder="Selecione sua área de atuação"
        >
          @for(area of areasAtuacao; track area.id_areas_atuacao){
          <mat-option [value]="area.id_areas_atuacao">
            {{ area.nome_area }}
          </mat-option>
          }
        </mat-select>
        @if (cadastrarForm.get('id_areas_atuacao')?.invalid &&
        (cadastrarForm.get('id_areas_atuacao')?.touched ||
        cadastrarForm.get('id_areas_atuacao')?.dirty)) {
        <mat-error>{{ fieldErrors()["id_areas_atuacao"] }}</mat-error>
        }
      </mat-form-field>
    </div>
    }
    <app-primary-input
      formControlName="email"
      type="email"
      inputName="email"
      label="Email"
      placeholder="Digite seu email"
      class="col-12"
    >
      @if (cadastrarForm.get('email')?.invalid &&
      (cadastrarForm.get('email')?.touched || cadastrarForm.get('email')?.dirty
      )) {
      <mat-error>{{ fieldErrors()["email"] }}</mat-error>
      }
    </app-primary-input>

    <div class="d-flex justify-content-end">
      <app-button-primary
        fonte="cpc-regular"
        color="btn-secondary"
        text="Salvar"
        (click)="submit()"
      />
    </div>
  </form>
</mat-dialog-content>
